!function(i){var n=function(n,t){var e,a,o,r,l,c,d,f;o=i(n);var s='<div id="inflo"><div id="inflc"></div><div id="infllc"><div class="arrow left"></div></div><div id="inflrc"><div class="arrow right"></div></div><div id="infliw"><div id="infli"></div><div id="inflh"><div id="inflht"></div></div></div><div id="inflil"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>',g=function(n){return i(document.getElementById(n))},h={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()}};l=[],c=0;var u=i.extend({caption:"Изображение $a из $b",margin:100,marginMobile:10,speed1:200,speed2:200,helper:!0,helperType:"number",animateImage:function(n,t,e){var a=g("infliw");a.width()==Math.floor(n)&&a.height()==Math.floor(t)?(g("#inflil").hide(),i("#infli > img").css({opacity:1})):a.css({"margin-top":e,width:Math.floor(n),height:Math.floor(t)}).on("webkitTransitionEnd transitionend oTransitionEnd otransitionend MSTransitionEnd",function(){g("inflil").hide(),i("#infli > img").css({opacity:1})})},clearBox:function(){var n=i("#infli > img");null!=n&&"underfined"!=n&&(n.css({opacity:0}),g("infli").empty())}},t||{}),v=function(){d="";var n=i("#infli > img").attr("data-margin");k(i("#infli > img").get(0),n)},m=function(){var n=i("#infli > img").attr("data-context"),t=i("#"+n+' a[data-img="'+i("#infli > img").attr("src")+'"]').prev();t.children("img").data("direction","prev"),t.children("img").click(),i(document).trigger("infinity-prev")},p=function(){var n=i("#infli > img").attr("data-context"),t=i("#"+n+' a[data-img="'+i("#infli > img").attr("src")+'"]').next();t.children("img").data("direction","next"),t.children("img").click(),i(document).trigger("infinity-next")},y=function(){o.find("a > img").data("direction",""),i("#inflo").hide(),i("body").css({"overflow-y":"scroll"}),i(document).trigger("infinity-close")},w=function(i){return{"-webkit-transition":"all "+i+"ms ease 0s","-moz-transition":"all "+i+"ms ease 0s","-o-transition":"all "+i+"ms ease 0s",transition:"all "+i+"ms ease 0s"}},b=function(i){37===i.keyCode?m():39===i.keyCode&&p()},k=function(n,t){var r,l,c,f,s=w(u.speed2);r=n.width/n.height,a=i(window).width()-2*t-8,e=i(window).height()-2*t-8,a>e?(f=e,c=f*r):(c=a,f=c/r),c>a?(c=a,f=c/r):f>e&&(f=e,c=f*r),l=-1*f/2-4,i(n).css({opacity:0}).attr("data-aspect",r).attr("data-margin",t).attr("data-context",o.context.id).css(s),g("infli").empty().append(n),u.animateImage(c,f,l,d)};if(o.data("settings",u),0==g("inflo").length&&i("body").append(s),null==o.attr("id")){var x=Math.floor(99*Math.random());o.attr("id","infinityLightbox"+x)}o.find("a[data-img]").click(function(n){var t,e=o.data("settings");if(i("#infliw, #infli").css(w(e.speed1)),d=i(n.target).data("direction")||"",i(document).trigger("infinity-open"),n.preventDefault(),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0,i("body").css({overflow:"hidden"}),h.any()&&(i("#infllc, #inflrc").addClass("mobile"),g("inflo").css({"background-color":"#000"}),g("inflc").show()),i("#inflrc, #infllc").css({opacity:"1"}).show(),e.clearBox(d),g("inflo").show(),g("inflil").show(),g("inflh").show(),t=o.find("a[data-img]"),c=t.index(i(n.target).parent("a")),-1===c&&(c=t.index(i(n.target))),length=t.length,c==length-1&&i("#inflrc").css({opacity:"0"}).hide(),0==c&&i("#infllc").css({opacity:"0"}).hide(),e.helper===!0){if("number"==e.helperType)i("#inflht").text(e.caption.replace("$a",c+1).replace("$b",length));else if("alt"==e.helperType){var a=i(n.target).attr("alt")||"";""!==a?g("inflht").text(a):g("inflh").hide()}}else g("inflh").hide();margin=h.any()?e.marginMobile:e.margin,null!=l[c]?k(l[c],margin):(r=new Image,r.src=t[c].getAttribute("data-img"),i(r).load(function(){l[c]=r,k(r,margin)})),i(window).off("resize",v),i(window).on("resize",v),i(document).off("keydown",b),i(document).on("keydown",b)}),g("inflrc").off("click"),g("inflrc").on("click",p),g("infllc").off("click"),g("infllc").on("click",m),g("infli").off("touchmove"),g("infli").off("touchstart"),g("infli").on("touchstart",function(i){var n=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];f=n.clientX}),g("infli").on("touchmove",function(i){var n,t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0],e=t.clientX;n=e>f?"right":"left","right"===n?m():p()}),g("inflo").click(function(n){"inflo"===i(n.target).attr("id")&&y()}),g("inflc").click(y)};i.fn.infinityLightbox=function(t){return this.each(function(){var e=i(this);if(!e.data("infinityLightbox")){var a=new n(this,t);e.data("infinityLightbox",a)}})}}(window.jQuery);